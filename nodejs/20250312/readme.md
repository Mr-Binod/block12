


# 암호화 환경변수 설정

> 관계형 데이터베이스란 제약조건 인덱싱의 개념 이번주
> 체득 시간을 보고

# 과제
> sql crud 만드는거

> 비밀번호를 저장할떄 원본 값을 저장하면 안된다.
> id : soon, pw : admin1231
> 요즘 사이트에 회원가입을 하면 로그인할때 비밀번호를 잊어버렸다.
> 비밀번호 찾기를 하면 본인인증을 하고 비밀번호를 다시 변경하라고 한다.
> 원본의 비밀번호를 알려주지 않는다. 원본 비밀번호와 값을 입력한 값과 일치한지 만 확인 할수 있다.

### 암호화  (encryption)
> 암호화는 데이터를 안전하게 관리하기 위해서 특정한 알고리즘을 사용해서 원래의 값을 숨기는 과정.

> 사용하는 데이터를 복원하기 위해서 키값을 사용한다.

### 해시 함수
> 해시 함수는 전달한 데이터의 크기를 저장하고 고유한 값으로 변환하는 알고리즘
> 안녕 + 새로운값 -> 고정된 해시 문자열로 변환

### sha256
> sha256 보안적으로 이슈가 가장 적었던 알고리즘
> 암호학적 해시 함수
> 256비트의 (32바이트) 고정된 길이의 해시값을 만드는 함수
> 원본의 값을 변환한 값이 항상 동일하다
> sha256 는 주로 데이터의 검증의 암호화의 알고리즘으로 사용되고 비밀번호
> 디지털 서면, 블록체인 등 사용이 된다.
> sha256을 사용하는 이유는 보안성 무결성 검증


### sha256 안호화
```js
const crypto = require('crypto'); //내장 모듈
const upw = 'admin123';

// 해시화 : 알고리즘을 통해서 데이터의 고정된 크기의 고유한 값으로 바꿔주는 행위. 16 진수의 값으로 변환 고정된 크기의 문자열

// 알고리즘은 sha256알고리즘 사용
// 데이터를 256비트의 고저 크기 값으로 변환해주는 알고리즘 
// 웜본 데이터의 길이에 상관없이 고정된 크기의 해시 값으로 변경을해준다.

// createHash 메서드의 매개변수로 사용할 해시 함수 알고리즘 이름
const hash = crypto.createHash('sha256');
// hash 반환된 객체의 메서드를 사용해서 문자열 해시화
// update : 문자열을 해시화 
const hasing = has.update(upw);


// hash 문자열 반환
// 64 자리의 크기의 문자열 16 짐수로 표현된
const hashString = hashing.digest('hex');

console.log(hashing);
console.log(hashString, hashString.length);

// Hash {
//   _options: undefined,
//   [Symbol(kHandle)]: Hash {},
//   [Symbol(kState)]: { [Symbol(kFinalized)]: true }
// }
// 240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9 64

// 솔트의 값을 사용해서 예측이 불가능한 데이터를 만들어 줘야한다.

```

### salt(솔트)
> hash 함수의 값은 값을 입력받으면 동일한 해시 문자열을 생성하기 때문에 
보안적인 문제가 발생할수 있다. 비밀번호를 쉽게 유추할수 없고록 솔트의 값을 추가해서 보안성을 졸게만든다.

### 키 스트레칭 기법
> salt만으로 해커의 공격을 차단하기는 힘들기 떄문에 귀찮게 하고 보완하기 위해서 키 스트레칭 기법을 사용한다.
> 해시 함수를 여러번 연산 반복해서 시간을 지연시킨다 오래 걸리게
> 솔트의 반복 연산을 오래걸리게 지연시켜서 해킹을 귀찮게 만든다

### 비밀번호 암호화해서 회원가입 만들어 보기

### mysql에 회원 정보 저장
```js
const sqlpool = mysql.createPool({
    user : 'myid',
    password : '1994!BDs',
    database : 'project',
    multipleStatements : true,
    host : 'localhost',
    port : 3306
})

// mysql 의 옵션을 전달할때 코드가 노출된 위험성이 있기때문에
// 우리의 컴퓨터의 환경변수를 사용해서 안전하게 사용하는 방법이 있다
// 환경 변수를 프로그램을 실행시킬때 환경변수로 저장하고 프로그램에서 환경변수에 접근해서 사용하는 방식
//  .env


// env 환경 변수를 저장하는 text 파일 
// 환경변수로 추가할 내용을 작성할 text 민감한 정보들 api key
// 서버에 운영을 하는경우 파일로 .env 를 파일로 업로드하면 안되고 서버측에 ssh 안전하게 접근해서 
// 접속해서 생성을 따로 해줘야한다

DATABASE_USER=myid
DATABASE_PASSWORD=1994!BDs
DATABASE_HOST=localhost
DATABASE_PORT=3306

```

### 오늘의 실습

> 회원 가입할때 닉네임 추가
> 정규식 사용해서 프론트에서 
> 아니티는 8 자까지 영어 대소문자 가능 특수문자 X 숫자 시작 X
> 비밀번호 특수문자 1 이상 포함 대문자 1 개 이상 포함 자리는 최소 8 자리에서 최대 14 자리까지
> 닉네임은 중복되도 된다
> 아니디는 중복 X
> 닉네임 변경과 회원 탈퇴


