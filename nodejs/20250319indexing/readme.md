



# my sql의 인덱싱과 B-tree

> 데이터의 양이 많아질수록 슬로우 퀴리 발생하고 속도가 저하되는 현상이 발생할수 있는데
> 특정 조건에 맞는 데이터를 조회할때 조회속도를 빠르게 최적화한다 검색을 빠르게 할수 있는 알고리즘을 사용할수 있는 것
> 탐색의 시간 복잡도가 줄어든다.

## 인덱스 ㅣ구조
- index
> node 가 100% 50% 50%  로 나눠서 이진 서치 tree 구조 

                                                                 O
                                                               /    \
                                                            O~50   50~100
                                                           /   \    /   \
                                                        O~25 25~50 50~75 75~100

- multi column index


### b-tree 라는 것은
> 이진 탐색 트리 : 모든 노드의 왼쪽 트리는 해당 부모 노드의 값보다 작은 값을 가지고 있고 오른쪽 트리에는 
부모 노드보다 큰 값을 가지고 있다 자식노드는 2개를 가질수있다. 
> 자식 노드의 갯수를 많이 가질수 없을까?
> 이진 탐색 트리를 일반적으로 표현한것이 Btree
> 차수로 표현을 하는데 차수에 따라서 자식 노드의 갯수가 정해진다.
> M 각 노드의 자식 노드 갯수
> 갓 노드의 자식 최대 키의 갯숫를 구하기위해서는 M - 1
> 자식노드의 갯수는 M/2 그리고 반올림
> 각 노드의 최소 키의 갯수는 M/2 - 1 
                                                    
## mysql 의 옵티마이저 
> mysql에서 sql 쿼리를 호출해서 조회를 할때 최적화된 조회를 하기위해서 판단해주는 엔진

```sql
create table users (
    name varchar(10),
    age int
)

# users 의 테이블에 데이터가 10 만개 10 만대 등 등 무척많다고 가정하면
# full scan 전체의 값을 조회한다 . 전체를 순회하기 떄문에 속도가 저하된다.

create index indx_users_age on users (age);
create unique index idx users_name_age on users(name, age);

show index from users;

```

## index 의 중요성 
> 테이블의 저장된 데이터에 대한 접근이 빠른 경로를 제공하는 자료 구조이다.

## index의 종료 
> index 

> 멀티 컬럼 인덱스(유니크) multi column index


## index 구조

```sql 
-- 학생 테이블을 만들고 인덱싱 설정 해보자
primary key 는 인덱싱 되어있다

CREATE TABLE student(
    id INT AUTO_INCREMENT PRIMARY KEY, 
    name varchar(20), 
    email varchar(20),
    age int,
    class varchar(20)
    );

```


1. 요구사향 분석
-- 페이지가 어떻게 동작하고 어떤 내용이 필요한 페이지인지 요구사항 분석

2. 필요한 테이블 설계
-- 데이터를 저장할 테이블을 설계 - > ERD

3. 테이블에 필요한 필드 설계
-- 필드들의 데이터타입을 어떻게 설계할지
-- 인덱스 설정 > 본인의 판단

4. 데이터베이스 생성
-- 관계성 확인 erd 뽑아서 관계성 확인

### 실습 요구사항
> 저는 항공사 웹페이지를 만들고 싶어요
> 사용자의 계정의 정보가 필요하고 사용자는 여권 등록을 할수 있어요
> 여권 등록이 되면 비행기 예약을 할수 있어요.
> 비행기를 예약한후에 음식을 계약 할수 있어용자리도 예약을 할수 있어요

> 사용자의 정보는 이름과 나이 성별
> 여권은 이름과 성별 여권 번호(8) 유효한기간 
> 비행기 예약에는 정보가 비행기 번호, 출발지, 도작지
> 음식 예약은 주문한 사람, 음식 이름, 가격
> 비행기 자리 예약은 자리번호 


> 조회는 mypage 접근하면 
> 사용자 정보가 보이고 비행기 예약 정보에소 비행기 번호 주문한 음식 이름 자리번호
> 비행기 예약 조회 페이지 모든 사용자의 정보에 이름이 보이고 출발지 도착지 비행기 번호
> 여권 유효 조회 페이지 모든 사용자의 정보에 이름이 보이고 출발지 도착지 비행기 번호